<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ö—Ä—É—á–µ–Ω–∏–µ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
            animation: gradientShift 10s ease infinite;
            background-size: 200% 200%;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
      }

      .container {
            max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        overflow: hidden;
      }

      .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        color: white;
            padding: 40px 30px;
        text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
      }

      .header h1 {
            font-size: 32px;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            text-shadow: 0 3px 10px rgba(0,0,0,0.3);
            animation: fadeInDown 1s ease;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .header p {
            font-size: 15px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
      }

      .tabs {
        display: flex;
            background: #ecf0f1;
            border-bottom: 3px solid #bdc3c7;
      }

      .tab {
        flex: 1;
            padding: 15px;
            text-align: center;
        cursor: pointer;
            font-weight: bold;
        transition: all 0.3s;
            background: #ecf0f1;
            border: none;
            font-size: 14px;
        }
        
        .tab:hover {
            background: #d5dbdb;
        }
        
        .tab.active {
            background: #3498db;
            color: white;
      }

      .tab-content {
        display: none;
        padding: 30px;
      }

      .tab-content.active {
        display: block;
      }

      .form-group {
        margin-bottom: 20px;
      }

        .form-group label {
        display: block;
            font-weight: bold;
            margin-bottom: 5px;
        color: #2c3e50;
      }

        .form-group input,
        .form-group select {
        width: 100%;
            padding: 10px;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            font-size: 14px;
            transition: border 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus {
        outline: none;
        border-color: #3498db;
      }

      .btn {
        padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 15px;
            font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
            margin: 5px;
        }
        
        .btn-primary {
            background: #27ae60;
            color: white;
        }
        
        .btn-primary:hover {
            background: #229954;
        transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
      }

      .btn-secondary {
            background: #3498db;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #e67e22, #d35400);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.4);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: white;
            margin: 3% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 1200px;
            max-height: 85vh;
            overflow-y: auto;
            animation: slideDown 0.4s ease;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px 30px;
            border-radius: 15px 15px 0 0;
        }
        
        .modal-header h2 {
            margin: 0;
            font-size: 24px;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .close {
            color: white;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            line-height: 20px;
        }
        
        .close:hover {
            transform: rotate(90deg);
            transition: transform 0.3s;
        }
        
        .examples-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .examples-table th {
            background: #34495e;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        
        .examples-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .examples-table tr:hover {
            background: #f8f9fa;
            cursor: pointer;
        }
        
        .examples-table tr.selected {
            background: #3498db;
            color: white;
        }
        
        .example-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 11px;
        }
        
        .badge-steel {
            background: #3498db;
            color: white;
        }
        
        .badge-cast-iron {
            background: #95a5a6;
            color: white;
        }
        
        .badge-wood {
            background: #27ae60;
            color: white;
        }
        
        .results-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
      }

      .graph-container {
        text-align: center;
            margin-top: 20px;
      }

      .graph-container img {
        max-width: 100%;
        border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
      
      .graph-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
      
      .card {
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            padding: 20px;
            border: 1px solid #ecf0f1;
        }
      
      .badge-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
      
      .metric-chip {
            padding: 10px 14px;
            border-radius: 10px;
            font-weight: bold;
            color: #2c3e50;
            background: #ecf0f1;
            border: 1px solid #dcdde1;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
      
      .metric-chip.success { background: #e9f7ef; color: #1e8449; border-color: #c8e6c9; }
      .metric-chip.info { background: #e8f4fd; color: #21618c; border-color: #d6eaf8; }
      .metric-chip.warn { background: #fef5e7; color: #b9770e; border-color: #f9e79f; }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .graph-grid {
                grid-template-columns: 1fr;
            }
      }

      .loading {
            display: none;
        text-align: center;
        padding: 20px;
        }
        
        .loading.active {
            display: block;
      }

      .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
            margin: 0 auto;
      }

      @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .test-question {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        
        .test-question h3 {
            color: #2c3e50;
        margin-bottom: 10px;
        }
        
        .test-option {
            padding: 8px;
            margin: 5px 0;
        }
        
        .test-option input[type="radio"] {
            margin-right: 10px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
      }
    </style>
  </head>
  <body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div class="header">
            <h1>üîß –õ–ê–ë–û–†–ê–¢–û–†–ù–ê–Ø –†–ê–ë–û–¢–ê ‚Ññ4: –ö–†–£–ß–ï–ù–ò–ï üîß</h1>
            <p>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è —É–ø—Ä—É–≥–æ—Å—Ç–∏ –≤—Ç–æ—Ä–æ–≥–æ —Ä–æ–¥–∞ –ø—Ä–∏ –∫—Ä—É—á–µ–Ω–∏–∏ —Å—Ç–∞–ª–∏, —á—É–≥—É–Ω–∞, –¥–µ—Ä–µ–≤–∞</p>
            <p style="margin-top: 10px; font-size: 12px;">–ê–≤—Ç–æ—Ä—ã: –ö–æ–≤–∞–ª–µ–Ω–∫–æ –ö., –ò–æ–∫–µ—Ä—Å –ê. | –ì—Ä—É–ø–ø–∞: –ò–ù-31 | 2025</p>
      </div>

        <!-- –¢–∞–±—ã -->
      <div class="tabs">
            <button class="tab active" onclick="switchTab(0)">üìä –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç</button>
            <button class="tab" onclick="switchTab(1)">üìà –ì—Ä–∞—Ñ–∏–∫–∏</button>
            <button class="tab" onclick="switchTab(2)">üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</button>
            <button class="tab" onclick="switchTab(3)">üìù –¢–µ—Å—Ç</button>
      </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç -->
        <div id="tab0" class="tab-content active">
            <h2>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞</h2>
            
            <div class="grid">
                <div>
              <div class="form-group">
                        <label>–§–ò–û:</label>
                        <input type="text" id="userName" value="–ö–æ–≤–∞–ª–µ–Ω–∫–æ –ö., –ò–æ–∫–µ—Ä—Å –ê.">
              </div>

              <div class="form-group">
                        <label>–ì—Ä—É–ø–ø–∞:</label>
                        <input type="text" id="userGroup" value="–ò–ù-31">
              </div>

              <div class="form-group">
                        <label>–ú–∞—Ç–µ—Ä–∏–∞–ª:</label>
                        <select id="material">
                            <option value="–°—Ç–∞–ª—å">–°—Ç–∞–ª—å</option>
                            <option value="–ß—É–≥—É–Ω">–ß—É–≥—É–Ω</option>
                            <option value="–î–µ—Ä–µ–≤–æ">–î–µ—Ä–µ–≤–æ</option>
                        </select>
              </div>
                    
                    <div class="form-group">
                        <label>–î–∏–∞–º–µ—Ç—Ä D (–º–º):</label>
                        <input type="number" id="diameter" value="10" step="0.1" min="1">
            </div>

              <div class="form-group">
                        <label>–î–ª–∏–Ω–∞ L (–º–º):</label>
                        <input type="number" id="length" value="200" step="1" min="10">
              </div>

              <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç T (–ù¬∑–º):</label>
                        <input type="number" id="maxMoment" value="100" step="1" min="1">
              </div>

              <div class="form-group">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –∏–∑–º–µ—Ä–µ–Ω–∏—è:</label>
                        <input type="number" id="numPoints" value="50" step="1" min="10" max="200">
              </div>
                    
                    <button class="btn btn-warning" onclick="showExamples()" style="width: 100%; margin-bottom: 15px;">üìö –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã</button>
                    <button class="btn btn-primary" onclick="performCalculation()">üî¨ –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç</button>
                    <button class="btn btn-secondary" onclick="saveToDatabase()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î</button>
                </div>

                <div>
                    <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞:</h3>
                    <div id="results" class="results-box">
                        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ —Ä–∞—Å—á–µ—Ç–∞...
                    </div>
                    <div id="resultBadges" class="badge-row"></div>
          </div>
        </div>

            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–∞—Å—á–µ—Ç...</p>
            </div>
      </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ì—Ä–∞—Ñ–∏–∫–∏ -->
        <div id="tab1" class="tab-content">
            <h2>üìà –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã</h2>
            
            <div class="graph-grid">
                <div class="card">
                    <div style="text-align: center; margin-bottom: 14px;">
                        <button class="btn btn-secondary" onclick="showGraph('torsion')">üìä –î–∏–∞–≥—Ä–∞–º–º–∞ T-œÜ</button>
                        <button class="btn btn-secondary" onclick="showGraph('stress')">üìâ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ œÑ</button>
                    </div>
                    <div id="graphContainer" class="graph-container">
                        <p>–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä–∞—Å—á–µ—Ç, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏—Ç–µ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>
                    </div>
                </div>
                <div class="card" style="text-align: center;">
                    <h3 style="margin-bottom: 10px;">üé¨ –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞</h3>
                    <p style="font-size: 13px; color: #5d6d7e;">–§—Ä–∞–≥–º–µ–Ω—Ç –∏–∑ –º–µ—Ç–æ–¥–∏—á–∫–∏ (–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è GIF)</p>
                    <img id="animationPreview" src="/animation/sample" alt="Torsion animation" style="max-width: 100%; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                    <p style="margin-top: 8px; font-size: 12px; color: #7f8c8d;">–î–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –≤ –¥–µ—Å–∫—Ç–æ–ø-–≤–µ—Ä—Å–∏–∏.</p>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö -->
        <div id="tab2" class="tab-content">
            <h2>üíæ –ò—Å—Ç–æ—Ä–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤</h2>
            
            <button class="btn btn-secondary" onclick="loadExperiments()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
            
            <div id="experimentsList" style="margin-top: 20px;">
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤...</p>
        </div>
      </div>

        <!-- –í–∫–ª–∞–¥–∫–∞: –¢–µ—Å—Ç -->
        <div id="tab3" class="tab-content">
            <h2>üìù –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Ç–µ—Å—Ç (8 –≤–æ–ø—Ä–æ—Å–æ–≤)</h2>
            
            <div id="testQuestions"></div>
            
            <button class="btn btn-primary" onclick="checkTest()">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
            
            <div id="testResult" style="margin-top: 20px;"></div>
      </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ -->
    <div id="examplesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="close" onclick="closeExamples()">&times;</span>
                <h2>üìö –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞</h2>
                <p style="margin-top: 10px; font-size: 14px; opacity: 0.9;">
                    –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—Å—è
                </p>
            </div>
            <div class="modal-body">
                <table class="examples-table">
                    <thead>
                        <tr>
                            <th>‚Ññ</th>
                            <th>–ú–∞—Ç–µ—Ä–∏–∞–ª</th>
                            <th>–î–∏–∞–º–µ—Ç—Ä D, –º–º</th>
                            <th>–î–ª–∏–Ω–∞ L, –º–º</th>
                            <th>–ú–∞–∫—Å. –º–æ–º–µ–Ω—Ç T, –ù¬∑–º</th>
                            <th>G —ç—Ç–∞–ª–æ–Ω, –ú–ü–∞</th>
                            <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        </tr>
                    </thead>
                    <tbody id="examplesTableBody">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <script>
        let currentResults = null;
        let selectedExampleRow = null;
        
        // –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã
        const examples = [
            {material: '–°—Ç–∞–ª—å', diameter: 10.0, length: 200.0, max_moment: 100.0, G: 81000, desc: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Å—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–∑–µ—Ü'},
            {material: '–°—Ç–∞–ª—å', diameter: 15.0, length: 250.0, max_moment: 200.0, G: 81000, desc: '–£—Å–∏–ª–µ–Ω–Ω—ã–π —Å—Ç–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–∑–µ—Ü'},
            {material: '–ß—É–≥—É–Ω', diameter: 12.0, length: 180.0, max_moment: 80.0, G: 40000, desc: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —á—É–≥—É–Ω–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü'},
            {material: '–ß—É–≥—É–Ω', diameter: 18.0, length: 220.0, max_moment: 150.0, G: 40000, desc: '–£—Å–∏–ª–µ–Ω–Ω—ã–π —á—É–≥—É–Ω–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü'},
            {material: '–î–µ—Ä–µ–≤–æ', diameter: 20.0, length: 300.0, max_moment: 50.0, G: 500, desc: '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü (—Å–æ—Å–Ω–∞)'},
            {material: '–î–µ—Ä–µ–≤–æ', diameter: 25.0, length: 350.0, max_moment: 70.0, G: 500, desc: '–î–µ—Ä–µ–≤—è–Ω–Ω—ã–π –æ–±—Ä–∞–∑–µ—Ü (–¥—É–±)'},
            {material: '–°—Ç–∞–ª—å', diameter: 8.0, length: 150.0, max_moment: 60.0, G: 81000, desc: '–¢–æ–Ω–∫–∏–π —Å—Ç–∞–ª—å–Ω–æ–π —Å—Ç–µ—Ä–∂–µ–Ω—å'},
            {material: '–ß—É–≥—É–Ω', diameter: 10.0, length: 200.0, max_moment: 90.0, G: 40000, desc: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —á—É–≥—É–Ω–Ω—ã–π –≤–∞–ª'}
        ];
        
        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏–º–µ—Ä–æ–≤
        function populateExamples() {
            const tbody = document.getElementById('examplesTableBody');
            tbody.innerHTML = '';
            
            examples.forEach((ex, idx) => {
                const row = tbody.insertRow();
                row.onclick = () => selectExample(idx);
                row.ondblclick = () => { selectExample(idx); applyExample(); };
                
                let badgeClass = '';
                if (ex.material === '–°—Ç–∞–ª—å') badgeClass = 'badge-steel';
                else if (ex.material === '–ß—É–≥—É–Ω') badgeClass = 'badge-cast-iron';
                else badgeClass = 'badge-wood';
                
                row.innerHTML = `
                    <td style="font-weight: bold; text-align: center;">${idx + 1}</td>
                    <td><span class="example-badge ${badgeClass}">${ex.material}</span></td>
                    <td>${ex.diameter.toFixed(1)}</td>
                    <td>${ex.length.toFixed(1)}</td>
                    <td>${ex.max_moment.toFixed(1)}</td>
                    <td>${ex.G.toLocaleString()}</td>
                    <td><em>${ex.desc}</em></td>
                `;
            });
        }
        
        function showExamples() {
            populateExamples();
            document.getElementById('examplesModal').style.display = 'block';
        }
        
        function closeExamples() {
            document.getElementById('examplesModal').style.display = 'none';
            selectedExampleRow = null;
        }
        
        function selectExample(idx) {
            const tbody = document.getElementById('examplesTableBody');
            const rows = tbody.getElementsByTagName('tr');
            
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫
            for (let row of rows) {
                row.classList.remove('selected');
            }
            
            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
            rows[idx].classList.add('selected');
            selectedExampleRow = idx;
        }
        
        function applyExample() {
            if (selectedExampleRow === null) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä!');
                return;
            }
            
            const ex = examples[selectedExampleRow];
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('material').value = ex.material;
            document.getElementById('diameter').value = ex.diameter;
            document.getElementById('length').value = ex.length;
            document.getElementById('maxMoment').value = ex.max_moment;
            
            closeExamples();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const results = document.getElementById('results');
            results.textContent = `‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω –ø—Ä–∏–º–µ—Ä: ${ex.desc}\n–ú–∞—Ç–µ—Ä–∏–∞–ª: ${ex.material}, D=${ex.diameter}–º–º, L=${ex.length}–º–º, T_max=${ex.max_moment}–ù¬∑–º\n\n–ù–∞–∂–º–∏—Ç–µ "–í—ã–ø–æ–ª–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç" –¥–ª—è –∑–∞–ø—É—Å–∫–∞.`;
            results.style.background = '#d5f4e6';
            results.style.color = '#27ae60';
            
            setTimeout(() => {
                results.style.background = '#f8f9fa';
                results.style.color = 'inherit';
            }, 3000);
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('examplesModal');
            if (event.target == modal) {
                closeExamples();
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
        function switchTab(index) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            
            tabs[index].classList.add('active');
            contents[index].classList.add('active');
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            if (index === 2) {
                loadExperiments();
            } else if (index === 3) {
                loadTestQuestions();
            }
        }
        
        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞
        async function performCalculation() {
            const loading = document.getElementById('loading');
            const resultsDiv = document.getElementById('results');
            
            loading.classList.add('active');
            resultsDiv.textContent = '–†–∞—Å—á–µ—Ç...';
            
            const data = {
                material: document.getElementById('material').value,
                diameter: parseFloat(document.getElementById('diameter').value),
                length: parseFloat(document.getElementById('length').value),
                max_moment: parseFloat(document.getElementById('maxMoment').value),
                num_points: parseInt(document.getElementById('numPoints').value)
            };
            
            try {
                const response = await fetch('/api/calculate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentResults = result.results;
                    displayResults(result.results, data);
                } else {
                    resultsDiv.textContent = `–û—à–∏–±–∫–∞: ${result.error}`;
                }
            } catch (error) {
                resultsDiv.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
            } finally {
                loading.classList.remove('active');
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResults(results, inputData) {
            const text = `
${'='.repeat(70)}
  –†–ï–ó–£–õ–¨–¢–ê–¢–´ –≠–ö–°–ü–ï–†–ò–ú–ï–ù–¢–ê–õ–¨–ù–û–ì–û –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –ú–û–î–£–õ–Ø –°–î–í–ò–ì–ê
${'='.repeat(70)}

–ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï:
  ‚Ä¢ –ú–∞—Ç–µ—Ä–∏–∞–ª:                    ${inputData.material}
  ‚Ä¢ –î–∏–∞–º–µ—Ç—Ä D:                   ${inputData.diameter.toFixed(2)} –º–º
  ‚Ä¢ –î–ª–∏–Ω–∞ L:                     ${inputData.length.toFixed(2)} –º–º
  ‚Ä¢ –ü–æ–ª—è—Ä–Ω—ã–π –º–æ–º–µ–Ω—Ç –∏–Ω–µ—Ä—Ü–∏–∏ Jp:  ${results.Jp.toExponential(6)} –º‚Å¥
  ‚Ä¢ –ü–æ–ª—è—Ä–Ω—ã–π –º–æ–º–µ–Ω—Ç —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è Wp: ${results.Wp.toExponential(6)} –º¬≥

–†–ï–ó–£–õ–¨–¢–ê–¢–´ –†–ê–°–ß–ï–¢–ê:
  ‚Ä¢ –ú–æ–¥—É–ª—å —Å–¥–≤–∏–≥–∞ (—ç–∫—Å–ø.):       G = ${results.G_experimental.toFixed(2)} –ú–ü–∞
  ‚Ä¢ –ú–æ–¥—É–ª—å —Å–¥–≤–∏–≥–∞ (—ç—Ç–∞–ª–æ–Ω):      G = ${results.G_reference.toFixed(2)} –ú–ü–∞
  ‚Ä¢ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å:   Œ¥ = ${results.relative_error.toFixed(2)} %

–ú–ï–•–ê–ù–ò–ß–ï–°–ö–ò–ï –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò:
  ‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç:         T_max = ${results.T_max.toFixed(2)} –ù¬∑–º
  ‚Ä¢ –£–≥–æ–ª –ø—Ä–∏ T_max:              œÜ_max = ${results.phi_max.toFixed(5)} —Ä–∞–¥
                                        (${(results.phi_max * 180 / Math.PI).toFixed(3)}¬∞)
  ‚Ä¢ –ú–∞–∫—Å. –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ: œÑ_max = ${results.tau_max.toFixed(2)} –ú–ü–∞
  ‚Ä¢ –ú–∞–∫—Å. –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Å–¥–≤–∏–≥:      Œ≥_max = ${results.gamma_max.toFixed(5)} —Ä–∞–¥

–•–ê–†–ê–ö–¢–ï–† –†–ê–ó–†–£–®–ï–ù–ò–Ø:
  ${results.failure_type}

${'='.repeat(70)}
            `;
            
            document.getElementById('results').textContent = text;
            renderResultBadges(results);
        }
        
        function renderResultBadges(results) {
            const wrap = document.getElementById('resultBadges');
            if (!wrap) return;
            wrap.innerHTML = `
                <div class="metric-chip success">G—ç–∫—Å–ø: ${results.G_experimental.toFixed(1)} –ú–ü–∞</div>
                <div class="metric-chip info">G—ç—Ç–∞–ª–æ–Ω: ${results.G_reference.toFixed(1)} –ú–ü–∞</div>
                <div class="metric-chip warn">Œ¥: ${results.relative_error.toFixed(2)}%</div>
                <div class="metric-chip info">T_max: ${results.T_max.toFixed(1)} –ù¬∑–º</div>
                <div class="metric-chip info">œÑ_max: ${results.tau_max.toFixed(2)} –ú–ü–∞</div>
            `;
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        async function showGraph(type) {
            if (!currentResults) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä–∞—Å—á–µ—Ç!');
                return;
            }
            
            const container = document.getElementById('graphContainer');
            container.innerHTML = '<div class="spinner"></div><p>–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞...</p>';
            
            try {
                let data;
                
                if (type === 'torsion') {
                    data = {
                        moments: currentResults.moments,
                        angles: currentResults.angles
                    };
                } else if (type === 'stress') {
                    data = {
                        material: document.getElementById('material').value,
                        diameter: parseFloat(document.getElementById('diameter').value),
                        length: parseFloat(document.getElementById('length').value),
                        moment: currentResults.T_max
                    };
                }
                
                const response = await fetch(`/api/plot/${type}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
            });

            const result = await response.json();

            if (result.success) {
                    container.innerHTML = `<img src="${result.image}" alt="–ì—Ä–∞—Ñ–∏–∫">`;
            } else {
                    container.innerHTML = `<p>–û—à–∏–±–∫–∞: ${result.error}</p>`;
            }
          } catch (error) {
                container.innerHTML = `<p>–û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
        async function saveToDatabase() {
            if (!currentResults) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ä–∞—Å—á–µ—Ç!');
          return;
        }

            const data = {
                user_name: document.getElementById('userName').value,
                material: document.getElementById('material').value,
                diameter: parseFloat(document.getElementById('diameter').value),
                length: parseFloat(document.getElementById('length').value),
                input_params: {
                    max_moment: parseFloat(document.getElementById('maxMoment').value),
                    num_points: parseInt(document.getElementById('numPoints').value)
                },
                results: currentResults
            };
            
            try {
                const response = await fetch('/api/experiments', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert(`–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω (ID: ${result.experiment_id})`);
          } else {
                    alert(`–û—à–∏–±–∫–∞: ${result.error}`);
          }
        } catch (error) {
                alert(`–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
        async function loadExperiments() {
            const listDiv = document.getElementById('experimentsList');
            listDiv.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>';
            
            try {
                const response = await fetch('/api/experiments');
          const result = await response.json();

                if (result.success && result.experiments.length > 0) {
                    let html = '<table style="width:100%; border-collapse: collapse;">';
                    html += '<tr style="background:#ecf0f1;"><th style="padding:10px; border:1px solid #bdc3c7;">ID</th><th style="padding:10px; border:1px solid #bdc3c7;">–î–∞—Ç–∞</th><th style="padding:10px; border:1px solid #bdc3c7;">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th><th style="padding:10px; border:1px solid #bdc3c7;">–ú–∞—Ç–µ—Ä–∏–∞–ª</th><th style="padding:10px; border:1px solid #bdc3c7;">D (–º–º)</th><th style="padding:10px; border:1px solid #bdc3c7;">L (–º–º)</th></tr>';
                    
                    result.experiments.forEach(exp => {
                        html += `<tr>
                            <td style="padding:8px; border:1px solid #bdc3c7; text-align:center;">${exp.id}</td>
                            <td style="padding:8px; border:1px solid #bdc3c7;">${exp.timestamp}</td>
                            <td style="padding:8px; border:1px solid #bdc3c7;">${exp.user_name}</td>
                            <td style="padding:8px; border:1px solid #bdc3c7;">${exp.material}</td>
                            <td style="padding:8px; border:1px solid #bdc3c7; text-align:center;">${(exp.diameter * 1000).toFixed(2)}</td>
                            <td style="padding:8px; border:1px solid #bdc3c7; text-align:center;">${(exp.length * 1000).toFixed(2)}</td>
                        </tr>`;
                    });
                    
                    html += '</table>';
                    listDiv.innerHTML = html;
          } else {
                    listDiv.innerHTML = '<p>–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.</p>';
          }
        } catch (error) {
                listDiv.innerHTML = `<p>–û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ —Ç–µ—Å—Ç–∞
        function loadTestQuestions() {
            const questions = [
                { q: '1. –ö–∞–∫ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—Ç—Å—è –∑–∞–∫–æ–Ω –ì—É–∫–∞ –ø—Ä–∏ –∫—Ä—É—á–µ–Ω–∏–∏?', a: ['œÜ = T¬∑‚Ñì/(G¬∑Jp)', 'œÉ = E¬∑Œµ', 'œÑ = G¬∑Œ≥', 'F = k¬∑Œîl'] },
                { q: '2. –í –∫–∞–∫–æ–π —Ç–æ—á–∫–µ —Å–µ—á–µ–Ω–∏—è –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∫–∞—Å–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –ø—Ä–∏ –∫—Ä—É—á–µ–Ω–∏–∏?', a: ['–í —Ü–µ–Ω—Ç—Ä–µ —Å–µ—á–µ–Ω–∏—è', '–ù–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ R/2 –æ—Ç —Ü–µ–Ω—Ç—Ä–∞', '–ù–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –≤–∞–ª–∞ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å)', '–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –≤—Å–µ–º—É —Å–µ—á–µ–Ω–∏—é'] },
                { q: '3. –ö–∞–∫ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ–ª—è—Ä–Ω—ã–π –º–æ–º–µ–Ω—Ç –∏–Ω–µ—Ä—Ü–∏–∏ –∫—Ä—É–≥–ª–æ–≥–æ —Å–µ—á–µ–Ω–∏—è?', a: ['Jp = œÄ¬∑D¬≥/32', 'Jp = œÄ¬∑D‚Å¥/32', 'Jp = œÄ¬∑D¬≤/4', 'Jp = œÄ¬∑D‚Å¥/64'] },
                { q: '4. –ß—Ç–æ —Ç–∞–∫–æ–µ –º–æ–¥—É–ª—å —Å–¥–≤–∏–≥–∞ G?', a: ['–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–∏', '–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ —É–ø—Ä—É–≥–∏—Ö —Å–≤–æ–π—Å—Ç–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –ø—Ä–∏ —Å–¥–≤–∏–≥–µ', '–û—Ç–Ω–æ—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –∫ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏', '–ü—Ä–µ–¥–µ–ª –ø—Ä–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∫—Ä—É—á–µ–Ω–∏–∏'] },
                { q: '5. –í –∫–∞–∫–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –º–æ–¥—É–ª—å —Å–¥–≤–∏–≥–∞?', a: ['–ù', '–º–º', '–ú–ü–∞ (–ü–∞)', '—Ä–∞–¥'] },
                { q: '6. –ö–∞–∫–æ–≤ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å —Å–¥–≤–∏–≥–∞ –¥–ª—è —Å—Ç–∞–ª–∏?', a: ['8¬∑10‚Å¥ –ú–ü–∞', '2¬∑10‚Åµ –ú–ü–∞', '4¬∑10‚Å¥ –ú–ü–∞', '1¬∑10¬≥ –ú–ü–∞'] },
                { q: '7. –ö–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞—Å–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –ø–æ —Å–µ—á–µ–Ω–∏—é –∫—Ä—É–≥–ª–æ–≥–æ –≤–∞–ª–∞?', a: ['–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ', '–ü–æ –ø–∞—Ä–∞–±–æ–ª–∏—á–µ—Å–∫–æ–º—É –∑–∞–∫–æ–Ω—É', '–ü–æ –ª–∏–Ω–µ–π–Ω–æ–º—É –∑–∞–∫–æ–Ω—É (–æ—Ç 0 –≤ —Ü–µ–Ω—Ç—Ä–µ –¥–æ –º–∞–∫—Å–∏–º—É–º–∞ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏)', '–ú–∞–∫—Å–∏–º—É–º –≤ —Ü–µ–Ω—Ç—Ä–µ, –º–∏–Ω–∏–º—É–º –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏'] },
                { q: '8. –ö–∞–∫–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è –ø—Ä–∏ –∫—Ä—É—á–µ–Ω–∏–∏ —É —Å—Ç–∞–ª–∏?', a: ['–†–∞—Å—Å–ª–æ–µ–Ω–∏–µ –≤–¥–æ–ª—å –≤–æ–ª–æ–∫–æ–Ω', '–†–∞–∑—Ä—É—à–µ–Ω–∏–µ –ø–æ –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ–π –æ—Å–∏', '–†–∞–∑—Ä—É—à–µ–Ω–∏–µ –ø–æ –≤–∏–Ω—Ç–æ–≤–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ø–æ–¥ —É–≥–ª–æ–º 45¬∞ (—Å—Ä–µ–∑)', '–•—Ä—É–ø–∫–æ–µ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–µ –±–µ–∑ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏'] }
            ];
            
            let html = '';
            questions.forEach((item, i) => {
                html += `<div class="test-question">
                    <h3>${item.q}</h3>`;
                
                item.a.forEach((answer, j) => {
                    html += `<div class="test-option">
                        <input type="radio" name="q${i}" value="${j}" id="q${i}_${j}">
                        <label for="q${i}_${j}">${answer}</label>
                    </div>`;
                });
                
                html += '</div>';
            });
            
            document.getElementById('testQuestions').innerHTML = html;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–∞
        async function checkTest() {
            const answers = {};
            
            for (let i = 0; i < 8; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                if (selected) {
                    answers[i] = parseInt(selected.value);
                }
            }
            
            if (Object.keys(answers).length < 8) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã!');
          return;
        }

        try {
                const response = await fetch('/api/test', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        answers: answers,
                        user_name: document.getElementById('userName').value
                    })
          });

          const result = await response.json();

          if (result.success) {
                    let className = 'alert-success';
                    if (result.percentage < 50) className = 'alert-danger';
                    else if (result.percentage < 75) className = 'alert-info';
                    
                    document.getElementById('testResult').innerHTML = `
                        <div class="alert ${className}">
                            <h3>${result.grade}</h3>
                            <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: ${result.score} –∏–∑ ${result.total}</p>
                            <p>–ü—Ä–æ—Ü–µ–Ω—Ç: ${result.percentage.toFixed(1)}%</p>
                </div>
            `;
                } else {
                    alert(`–û—à–∏–±–∫–∞: ${result.error}`);
          }
        } catch (error) {
                alert(`–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }
        
        // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            console.log('–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
      });
    </script>
  </body>
</html>
